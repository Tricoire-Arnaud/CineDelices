<%- include('../partials/header') %>
<%- include('../partials/nav') %>

<main class="mx-auto max-w-4xl p-4 md:p-8">
  <article class="rounded-lg bg-white p-6 shadow-md">
    <img src="<%= recipe.img %>" alt="<%= recipe.name %>" class="mb-4 w-full rounded-lg" />
    <h2 class="mb-2 text-2xl font-bold text-gray-800"><%= recipe.titre%></h2>
    <p class="mb-4 text-sm text-gray-600"><%= movie.titre %> - <%= movie.annee %></p>
    <div class="mb-4 flex flex-col gap-4 md:flex-row md:items-center md:space-x-4">
      <div class="flex text-orange-600">
        <!-- nombre √©toiles -->
        <% for (let i = 0; i < recipe.difficulte; i++) { %>
          <span>&#9733;</span>
        <% } %>
        <% for (let i = recipe.difficulte; i < 5; i++) { %>
          <span class="text-gray-300">&#9733;</span>
        <% } %>
      </div>
      <p class="text-sm text-gray-600">(<%= reviewsCount %> avis)</p>
      <div>
        <ul class="list-disc list-inside text-sm">
          <li>üç¥ Cat√©gorie : <%- category.libelle %></li>
          <li>üïí Temps de pr√©paration : <%= recipe.temps_preparation %> min</li>
        </ul>
      </div>
    </div>
    
    <!-- existe/pas ou ajoute dans la db ? -->
    <section>
      <h3 class="mb-3 text-xl font-semibold text-orange-600">Pour r√©ussir cette recette comme dans le film :</h3>
      <ul class="mb-6 list-inside list-disc space-y-2 text-gray-700">
        <li>Utilisez des l√©gumes de taille similaire pour un r√©sultat plus esth√©tique</li>
        <li>La cuisson doit √™tre douce pour pr√©server les saveurs</li>
        <li>Servez la ratatouille chaude avec un filet d'huile d'olive</li>
      </ul>
    </section>
<!-- sinon -->
<section>
  <h3 class="mb-3 text-xl font-semibold text-orange-600">Anecdote</h3>
  <p class="mb-6 text-gray-700"><%- recipe.anecdote %></p>
  <!-- il y a des recettes sans anecdote -->
</section>

    <section class="mb-6 grid gap-4 md:grid-cols-2">
      <div>
        <h3 class="mb-3 text-xl font-semibold text-orange-600">Ingr√©dients</h3>
        <% if (ingredients.length) { %>
          <ul class="space-y-2 rounded-lg bg-red-50 p-4 list-disc list-inside">
            <% ingredients.forEach(ingredient => { %>
              <li><%- ingredient.nom_ingredient %> -- (<%- ingredient.unite_mesure %>)</li>
            <% }) %>
          </ul>
          <!-- en cas ou l'user n'a pas ajouter d'ingredient -->
        <% } else { %>
          <p>Aucun ingr√©dient disponible.</p>
        <% } %>
      </div>
      <div>
        <h3 class="mb-3 text-xl font-semibold text-orange-600">Ustensiles</h3>
        <% if (utensils.length) { %>
          <ul class="space-y-2 rounded-lg bg-red-50 p-4 list-disc list-inside">
            <% utensils.forEach(utensil => { %>
              <li><%- utensil.nom_ustensile %></li>
            <% }) %>
          </ul>
        <% } else { %>
          <p>Aucun ustensile requis.</p>
        <% } %>
      </div>
    </section>

    <section class="mb-6">
      <h3 class="mb-3 text-xl font-semibold text-orange-600">Instructions</h3>
      <ol class="list-inside list-decimal space-y-2 rounded-lg bg-red-50 p-4">
        <% JSON.parse(recipe.etapes).forEach(etape => { %>
          <li><%- etape %></li>
        <% }) %>
      </ol>
    </section>
 <!-- n'existe pas dans la db  -->
    <section>
      <h3 class="mb-3 text-xl font-semibold text-orange-600">Notes et astuces</h3>
      <ul class="list-inside list-disc space-y-2 rounded-lg bg-red-50 p-4">
        <li>Utilisez des l√©gumes de taille similaire pour un r√©sultat plus esth√©tique.</li>
        <li>La cuisson doit √™tre douce pour pr√©server les saveurs.</li>
        <li>Servez la ratatouille chaude avec un filet d'huile d'olive.</li>
      </ul>
    </section>

    <section>
      <h3 class="mb-3 text-xl font-semibold text-orange-600">Commentaires</h3>
      <% if (comments.length) { %>
        <ul class="list-inside list-disc space-y-2 rounded-lg bg-red-50 p-4">
          <% comments.forEach(comment => { %>
            <li><strong><%- comment.user.name %>:</strong> <%- comment.content %></li>
          <% }) %>
        </ul>
      <% } else { %>
        <p>Aucun commentaire pour le moment. Soyez le premier √† r√©agir !</p>
      <% } %>
    </section>
  </article>
</main>


<!-- Footer -->

<%- include('../partials/footer') %>
